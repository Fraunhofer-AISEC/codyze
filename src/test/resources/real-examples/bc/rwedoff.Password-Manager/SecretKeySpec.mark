package java

entity javax.crypto.spec.SecretKeySpec isa java.security.Key {

	var this : javax.crypto.spec.SecretKeySpec;

	var key : byte[];
	var algorithm : java.lang.String;
	
	op instantiate {
		this = javax.crypto.spec.SecretKeySpec(key, _, _, algorithm);
		this = javax.crypto.spec.SecretKeySpec(key, algorithm);
	}
	
}


rule UseValidAlgorithm {
	using
		javax.crypto.spec.SecretKeySpec as sks
	ensure
		sks.algorithm in ["AES"]
	onfail Wrong_Algorithm
}
