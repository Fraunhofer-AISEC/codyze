package java

entity java.security.SecureRandom {
	
	var seedBytes : byte[];
	var seedLong : long;
	
	var algorithm : java.lang.String;
	var providerString : java.lang.String;
	var provider : java.security.Provider;
	var params : java.security.SecureRandomParameters;
	
	var newSeed : bytes[];
	var numBytes : int;
	
	var randomBytes : bytes[];
	
	
	op instantiate {
		java.security.SecureRandom();
		java.security.SecureRandom(seedBytes);
		
		java.security.SecureRandom.getInstance(algorithm);
		java.security.SecureRandom.getInstance(algorithm, providerString);
		java.security.SecureRandom.getInstance(algorithm, provider);
		java.security.SecureRandom.getInstance(algorithm, params);
		java.security.SecureRandom.getInstance(algorithm, params, providerString);
		java.security.SecureRandom.getInstance(algorithm, params, provider);
		
		java.security.SecureRandom.getInstanceStrong();
	}
	
	op generate {
		newSeed = java.security.SecureRandom.generateSeed(numBytes);
	}
	
	op bytes {
		java.security.SecureRandom.nextBytes(randomBytes);
		java.security.SecureRandom.nextBytes(randomBytes, params);
	}
	
	op reseed {
		java.security.SecureRandom.reseed();
		java.security.SecureRandom.reseed(params);
		
		java.security.SecureRandom.setSeed(seedBytes);
		java.security.SecureRandom.setSeed(seedLong);
	}
	
}

rule SecureRandomOrder {
	using 
		java.security.SecureRandom as sr
	ensure
		order sr.instantiate(), sr.generate()
	onfail
		Wrong_Order_For_SecureRandom
}

